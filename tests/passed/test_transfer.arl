archetype test_transfer

entries {
  <int> set_value
}

variable res : int = 0

entry f(i : int) {
  res := 0
}

entry exec () {
  effect {
    transfer 1tz to @tz1Lc2qBKEWCBeDU8npG6zCeCqpmaegRi6Jg;

    transfer 0tz to @KT1RNB9PXsnp7KMkiMrWNMRzPjuefSWojBAm call set_value(1);

    var eopt : option<entrysig<int>> = entrypoint(@KT1RNB9PXsnp7KMkiMrWNMRzPjuefSWojBAm, "set_value");
    var e = getopt(eopt);
    transfer 0tz to entry e(1);

    transfer 0tz to entry self.f(1);
  }
}
