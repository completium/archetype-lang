archetype fa12_inspector

variable fa12 : address = @KT1BV7CwYdQoNrrDi5G8hmHiZNd7AGjPUQYX

variable totalSupply : nat = 0

variable res : nat = 0

entry checkTotalSupply() {
  res := if totalSupply > 5_000_000 then 1 else 2
}

entry setTotalSupply(v : nat) {
  called by fa12
  effect {
    totalSupply := v;
     transfer 0tz to entry self.checkTotalSupply()
  }
}

entry retrieveTotalSupply() {
  transfer 0tz to fa12 call getTotalSupply<entrysig<nat>>(self.setTotalSupply);
}